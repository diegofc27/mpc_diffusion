â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    script_path     â”‚ None                
    script_root     â”‚ /home/fernandi/projects/decision-diffuser/code/analysis
      counter       â”‚ 2                   
       prefix       â”‚ diffuser/safe_omni_combine_basic_3
        name        â”‚ safe_job            
       status       â”‚ created             
     createTime     â”‚ 2023-10-24 11:23:28.320775
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m      revision      [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        hash        â”‚ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       â”‚ refs/heads/main     
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m         fn         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        name        â”‚ evaluate            
        doc         â”‚ None                
       module       â”‚ scripts.evaluate_safe_parallel_eval
        file        â”‚ /home/fernandi/projects/decision-diffuser/code/scripts/evaluate_safe_parallel_eval.py
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        args        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
()
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       kwargs       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     RUN.prefix     â”‚ diffuser/safe_omni_combine_basic_3
     wandb_name     â”‚ safe_omni_combine_basic_3
   max_n_episodes   â”‚ 4054                
   action_weight    â”‚ 2                   
   loss_discount    â”‚ 0.99                
   skill_dataset    â”‚ ipo_ppo_69_4k       
  save_checkpoints  â”‚ False               
        seed        â”‚ 1234789             
 returns_condition  â”‚ False               
  skills_condition  â”‚ True                
  predict_epsilon   â”‚ True                
 n_diffusion_steps  â”‚ 300                 
 condition_dropout  â”‚ 0.25                
     diffusion      â”‚ models.GaussianDiffusionSkills
      dataset       â”‚ SafetyPointButton3-v0
       loader       â”‚ datasets.SkillsDataset
  max_path_length   â”‚ 1000                
      horizon       â”‚ 12                  
   n_train_steps    â”‚ 2010000.0           
   returns_scale    â”‚ 400.0               
  RUN.job_counter   â”‚ 1                   
    RUN.job_name    â”‚ safe_job            
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
taking diff, if this step takes too long, check if your uncommitted changes are too large.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       job_id       â”‚ None                
       status       â”‚ started             
     startTime      â”‚ 2023-10-24 11:23:50.725616
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        host        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      hostname      â”‚ nrgpu3.informatik.privat
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       Config       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        seed        â”‚ 1234789             
       device       â”‚ cuda:6              
       bucket       â”‚ /home/fernandi/projects/decision-diffuser/code/weights/
        runs        â”‚ /home/fernandi/projects/decision-diffuser/code/
      dataset       â”‚ SafetyPointButton3-v0
       model        â”‚ models.TemporalUnet 
     diffusion      â”‚ models.GaussianDiffusionSkills
      horizon       â”‚ 12                  
 n_diffusion_steps  â”‚ 300                 
   action_weight    â”‚ 2                   
    loss_weights    â”‚ None                
   loss_discount    â”‚ 0.99                
  predict_epsilon   â”‚ True                
     dim_mults      â”‚ (1, 4, 8)           
 returns_condition  â”‚ False               
  skills_condition  â”‚ True                
   goal_condition   â”‚ False               
    calc_energy     â”‚ False               
        dim         â”‚ 128                 
 condition_dropout  â”‚ 0.25                
condition_guidance_wâ”‚ 1.2                 
      test_ret      â”‚ 0.9                 
      renderer      â”‚ utils.MuJoCoRenderer
     attention      â”‚ False               
     include_xy     â”‚ False               
       loader       â”‚ datasets.SkillsDataset
     normalizer     â”‚ CDFNormalizer       
   preprocess_fns   â”‚ []                  
   clip_denoised    â”‚ True                
    use_padding     â”‚ True                
  include_returns   â”‚ True                
   include_costs    â”‚ False               
      discount      â”‚ 0.99                
  max_path_length   â”‚ 1000                
     hidden_dim     â”‚ 256                 
       ar_inv       â”‚ False               
   train_only_inv   â”‚ False               
termination_penalty â”‚ -100                
   returns_scale    â”‚ 400.0               
    costs_scale     â”‚ 130                 
   max_n_episodes   â”‚ 4054                
   point_dataset    â”‚ xy_dataset_20       
   skill_dataset    â”‚ ipo_ppo_69_4k       
 n_steps_per_epoch  â”‚ 10000               
     loss_type      â”‚ l2                  
   n_train_steps    â”‚ 2010000.0           
     batch_size     â”‚ 32                  
   learning_rate    â”‚ 0.0002              
gradient_accumulate_everyâ”‚ 2                   
     ema_decay      â”‚ 0.995               
      log_freq      â”‚ 1000                
     save_freq      â”‚ 10000               
    sample_freq     â”‚ 10000               
      n_saves       â”‚ 5                   
   save_parallel    â”‚ False               
    n_reference     â”‚ 8                   
  save_checkpoints  â”‚ False               
   wandb_project    â”‚ decision-diffuser   
    wandb_entity    â”‚ diegofc             
    wandb_group     â”‚ PandaPush-v3        
     wandb_tags     â”‚ ['decision-diffuser']
     wandb_name     â”‚ safe_omni_combine_basic_3
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        RUN         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       server       â”‚ /home/fernandi/projects/decision-diffuser/code
      username      â”‚ fernandi            
      project       â”‚ diffuser            
    script_root     â”‚ /home/fernandi/projects/decision-diffuser/code/analysis
    script_path     â”‚ None                
        now         â”‚ 2023-10-24 13:23:16.963252+02:00
       prefix       â”‚ diffuser/safe_omni_combine_basic_3
      job_name      â”‚ safe_job            
    job_counter     â”‚ 1                   
       resume       â”‚ True                
       readme       â”‚ None                
       debug        â”‚ False               
CUDA_VISIBLE_DEVICESâ”‚ None                
     file_stem      â”‚ eval                
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
59778366
Traceback (most recent call last):
  File "/home/fernandi/miniconda3/envs/safe3/lib/python3.9/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/fernandi/projects/decision-diffuser/code/scripts/evaluate_safe_parallel_eval.py", line 198, in evaluate
    frames.append(envs.render())
  File "/home/fernandi/projects/omnisafe/omnisafe/envs/safety_gymnasium_env.py", line 230, in render
    return self._env.render()
  File "/home/fernandi/miniconda3/envs/safe3/lib/python3.9/site-packages/gymnasium/core.py", line 418, in render
    return self.env.render()
  File "/home/fernandi/miniconda3/envs/safe3/lib/python3.9/site-packages/gymnasium/core.py", line 418, in render
    return self.env.render()
  File "/home/fernandi/miniconda3/envs/safe3/lib/python3.9/site-packages/gymnasium/wrappers/order_enforcing.py", line 70, in render
    return self.env.render(*args, **kwargs)
  File "/home/fernandi/miniconda3/envs/safe3/lib/python3.9/site-packages/gymnasium/wrappers/env_checker.py", line 63, in render
    return env_render_passive_checker(self.env, *args, **kwargs)
  File "/home/fernandi/miniconda3/envs/safe3/lib/python3.9/site-packages/gymnasium/utils/passive_env_checker.py", line 391, in env_render_passive_checker
    result = env.render()
  File "/home/fernandi/projects/safety-gymnasium/safety_gymnasium/builder.py", line 317, in render
    return self.task.render(cost=self.cost, **asdict(self.render_parameters))
  File "/home/fernandi/projects/safety-gymnasium/safety_gymnasium/bases/underlying.py", line 515, in render
    self._get_viewer(mode)
  File "/home/fernandi/projects/safety-gymnasium/safety_gymnasium/bases/underlying.py", line 568, in _get_viewer
    self.viewer = OffScreenViewer(self.model, self.data)
  File "/home/fernandi/miniconda3/envs/safe3/lib/python3.9/site-packages/gymnasium/envs/mujoco/mujoco_rendering.py", line 144, in __init__
    super().__init__(model, data, width, height)
  File "/home/fernandi/miniconda3/envs/safe3/lib/python3.9/site-packages/gymnasium/envs/mujoco/mujoco_rendering.py", line 61, in __init__
    self.con = mujoco.MjrContext(self.model, mujoco.mjtFontScale.mjFONTSCALE_150)
mujoco.FatalError: gladLoadGL error

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       status       â”‚ errored             
     errorTime      â”‚ 2023-10-24 11:26:45.588955
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    script_path     â”‚ None                
    script_root     â”‚ /home/fernandi/projects/decision-diffuser/code/analysis
      counter       â”‚ 2                   
       prefix       â”‚ diffuser/safe_omni_combine_basic_3
        name        â”‚ safe_job            
       status       â”‚ created             
     createTime     â”‚ 2023-10-24 11:37:45.927576
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m      revision      [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        hash        â”‚ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       â”‚ refs/heads/main     
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m         fn         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        name        â”‚ evaluate            
        doc         â”‚ None                
       module       â”‚ scripts.evaluate_safe_parallel_eval
        file        â”‚ /home/fernandi/projects/decision-diffuser/code/scripts/evaluate_safe_parallel_eval.py
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        args        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
()
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       kwargs       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     RUN.prefix     â”‚ diffuser/safe_omni_combine_basic_3
     wandb_name     â”‚ safe_omni_combine_basic_3
   max_n_episodes   â”‚ 4054                
   action_weight    â”‚ 2                   
   loss_discount    â”‚ 0.99                
   skill_dataset    â”‚ ipo_ppo_69_4k       
  save_checkpoints  â”‚ False               
        seed        â”‚ 1234789             
 returns_condition  â”‚ False               
  skills_condition  â”‚ True                
  predict_epsilon   â”‚ True                
 n_diffusion_steps  â”‚ 300                 
 condition_dropout  â”‚ 0.25                
     diffusion      â”‚ models.GaussianDiffusionSkills
      dataset       â”‚ SafetyPointButton3-v0
       loader       â”‚ datasets.SkillsDataset
  max_path_length   â”‚ 1000                
      horizon       â”‚ 12                  
   n_train_steps    â”‚ 2010000.0           
   returns_scale    â”‚ 400.0               
  RUN.job_counter   â”‚ 1                   
    RUN.job_name    â”‚ safe_job            
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
taking diff, if this step takes too long, check if your uncommitted changes are too large.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       job_id       â”‚ None                
       status       â”‚ started             
     startTime      â”‚ 2023-10-24 11:38:13.930533
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        host        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      hostname      â”‚ nrgpu3.informatik.privat
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       Config       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        seed        â”‚ 1234789             
       device       â”‚ cuda:6              
       bucket       â”‚ /home/fernandi/projects/decision-diffuser/code/weights/
        runs        â”‚ /home/fernandi/projects/decision-diffuser/code/
      dataset       â”‚ SafetyPointButton3-v0
       model        â”‚ models.TemporalUnet 
     diffusion      â”‚ models.GaussianDiffusionSkills
      horizon       â”‚ 12                  
 n_diffusion_steps  â”‚ 300                 
   action_weight    â”‚ 2                   
    loss_weights    â”‚ None                
   loss_discount    â”‚ 0.99                
  predict_epsilon   â”‚ True                
     dim_mults      â”‚ (1, 4, 8)           
 returns_condition  â”‚ False               
  skills_condition  â”‚ True                
   goal_condition   â”‚ False               
    calc_energy     â”‚ False               
        dim         â”‚ 128                 
 condition_dropout  â”‚ 0.25                
condition_guidance_wâ”‚ 1.2                 
      test_ret      â”‚ 0.9                 
      renderer      â”‚ utils.MuJoCoRenderer
     attention      â”‚ False               
     include_xy     â”‚ False               
       loader       â”‚ datasets.SkillsDataset
     normalizer     â”‚ CDFNormalizer       
   preprocess_fns   â”‚ []                  
   clip_denoised    â”‚ True                
    use_padding     â”‚ True                
  include_returns   â”‚ True                
   include_costs    â”‚ False               
      discount      â”‚ 0.99                
  max_path_length   â”‚ 1000                
     hidden_dim     â”‚ 256                 
       ar_inv       â”‚ False               
   train_only_inv   â”‚ False               
termination_penalty â”‚ -100                
   returns_scale    â”‚ 400.0               
    costs_scale     â”‚ 130                 
   max_n_episodes   â”‚ 4054                
   point_dataset    â”‚ xy_dataset_20       
   skill_dataset    â”‚ ipo_ppo_69_4k       
 n_steps_per_epoch  â”‚ 10000               
     loss_type      â”‚ l2                  
   n_train_steps    â”‚ 2010000.0           
     batch_size     â”‚ 32                  
   learning_rate    â”‚ 0.0002              
gradient_accumulate_everyâ”‚ 2                   
     ema_decay      â”‚ 0.995               
      log_freq      â”‚ 1000                
     save_freq      â”‚ 10000               
    sample_freq     â”‚ 10000               
      n_saves       â”‚ 5                   
   save_parallel    â”‚ False               
    n_reference     â”‚ 8                   
  save_checkpoints  â”‚ False               
   wandb_project    â”‚ decision-diffuser   
    wandb_entity    â”‚ diegofc             
    wandb_group     â”‚ PandaPush-v3        
     wandb_tags     â”‚ ['decision-diffuser']
     wandb_name     â”‚ safe_omni_combine_basic_3
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        RUN         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       server       â”‚ /home/fernandi/projects/decision-diffuser/code
      username      â”‚ fernandi            
      project       â”‚ diffuser            
    script_root     â”‚ /home/fernandi/projects/decision-diffuser/code/analysis
    script_path     â”‚ None                
        now         â”‚ 2023-10-24 13:37:35.201378+02:00
       prefix       â”‚ diffuser/safe_omni_combine_basic_3
      job_name      â”‚ safe_job            
    job_counter     â”‚ 1                   
       resume       â”‚ True                
       readme       â”‚ None                
       debug        â”‚ False               
CUDA_VISIBLE_DEVICESâ”‚ None                
     file_stem      â”‚ eval                
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
59778366
Traceback (most recent call last):
  File "/home/fernandi/miniconda3/envs/safe3/lib/python3.9/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/fernandi/projects/decision-diffuser/code/scripts/evaluate_safe_parallel_eval.py", line 211, in evaluate
    samples = trainer.ema_model.conditional_sample(conditions, skills=skills)
  File "/home/fernandi/miniconda3/envs/safe3/lib/python3.9/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/home/fernandi/projects/decision-diffuser/code/diffuser/models/diffusion.py", line 749, in conditional_sample
    return self.p_sample_loop(shape, cond, skills=skills, *args, **kwargs)
  File "/home/fernandi/miniconda3/envs/safe3/lib/python3.9/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/home/fernandi/projects/decision-diffuser/code/diffuser/models/diffusion.py", line 720, in p_sample_loop
    x = apply_conditioning(x, cond, self.action_dim)
  File "/home/fernandi/projects/decision-diffuser/code/diffuser/models/helpers.py", line 100, in apply_conditioning
    x[:, t, :] = val.clone()
RuntimeError: The expanded size of the tensor (62) must match the existing size (60) at non-singleton dimension 1.  Target sizes: [1, 62].  Tensor sizes: [60]

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       status       â”‚ errored             
     errorTime      â”‚ 2023-10-24 11:40:36.672647
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    script_path     â”‚ None                
    script_root     â”‚ /home/fernandi/projects/decision-diffuser/code/analysis
      counter       â”‚ 2                   
       prefix       â”‚ diffuser/safe_omni_combine_basic_3
        name        â”‚ safe_job            
       status       â”‚ created             
     createTime     â”‚ 2023-10-24 11:58:21.616179
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m      revision      [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        hash        â”‚ 01ce528c30b4733dc59aa6203e46ec165561158d
       branch       â”‚ refs/heads/main     
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m         fn         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        name        â”‚ evaluate            
        doc         â”‚ None                
       module       â”‚ scripts.evaluate_safe_parallel_eval
        file        â”‚ /home/fernandi/projects/decision-diffuser/code/scripts/evaluate_safe_parallel_eval.py
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        args        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
()
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       kwargs       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
     RUN.prefix     â”‚ diffuser/safe_omni_combine_basic_3
     wandb_name     â”‚ safe_omni_combine_basic_3
   max_n_episodes   â”‚ 4054                
   action_weight    â”‚ 2                   
   loss_discount    â”‚ 0.99                
   skill_dataset    â”‚ ipo_ppo_69_4k       
  save_checkpoints  â”‚ False               
        seed        â”‚ 1234789             
 returns_condition  â”‚ False               
  skills_condition  â”‚ True                
  predict_epsilon   â”‚ True                
 n_diffusion_steps  â”‚ 300                 
 condition_dropout  â”‚ 0.25                
     diffusion      â”‚ models.GaussianDiffusionSkills
      dataset       â”‚ SafetyPointButton3-v0
       loader       â”‚ datasets.SkillsDataset
  max_path_length   â”‚ 1000                
      horizon       â”‚ 12                  
   n_train_steps    â”‚ 2010000.0           
   returns_scale    â”‚ 400.0               
  RUN.job_counter   â”‚ 1                   
    RUN.job_name    â”‚ safe_job            
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
taking diff, if this step takes too long, check if your uncommitted changes are too large.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       job_id       â”‚ None                
       status       â”‚ started             
     startTime      â”‚ 2023-10-24 11:59:51.389138
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        host        [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      hostname      â”‚ nrgpu3.informatik.privat
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m       Config       [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        seed        â”‚ 1234789             
       device       â”‚ cuda:6              
       bucket       â”‚ /home/fernandi/projects/decision-diffuser/code/weights/
        runs        â”‚ /home/fernandi/projects/decision-diffuser/code/
      dataset       â”‚ SafetyPointButton3-v0
       model        â”‚ models.TemporalUnet 
     diffusion      â”‚ models.GaussianDiffusionSkills
      horizon       â”‚ 12                  
 n_diffusion_steps  â”‚ 300                 
   action_weight    â”‚ 2                   
    loss_weights    â”‚ None                
   loss_discount    â”‚ 0.99                
  predict_epsilon   â”‚ True                
     dim_mults      â”‚ (1, 4, 8)           
 returns_condition  â”‚ False               
  skills_condition  â”‚ True                
   goal_condition   â”‚ False               
    calc_energy     â”‚ False               
        dim         â”‚ 128                 
 condition_dropout  â”‚ 0.25                
condition_guidance_wâ”‚ 1.2                 
      test_ret      â”‚ 0.9                 
      renderer      â”‚ utils.MuJoCoRenderer
     attention      â”‚ False               
     include_xy     â”‚ False               
       loader       â”‚ datasets.SkillsDataset
     normalizer     â”‚ CDFNormalizer       
   preprocess_fns   â”‚ []                  
   clip_denoised    â”‚ True                
    use_padding     â”‚ True                
  include_returns   â”‚ True                
   include_costs    â”‚ False               
      discount      â”‚ 0.99                
  max_path_length   â”‚ 1000                
     hidden_dim     â”‚ 256                 
       ar_inv       â”‚ False               
   train_only_inv   â”‚ False               
termination_penalty â”‚ -100                
   returns_scale    â”‚ 400.0               
    costs_scale     â”‚ 130                 
   max_n_episodes   â”‚ 4054                
   point_dataset    â”‚ xy_dataset_20       
   skill_dataset    â”‚ ipo_ppo_69_4k       
 n_steps_per_epoch  â”‚ 10000               
     loss_type      â”‚ l2                  
   n_train_steps    â”‚ 2010000.0           
     batch_size     â”‚ 32                  
   learning_rate    â”‚ 0.0002              
gradient_accumulate_everyâ”‚ 2                   
     ema_decay      â”‚ 0.995               
      log_freq      â”‚ 1000                
     save_freq      â”‚ 10000               
    sample_freq     â”‚ 10000               
      n_saves       â”‚ 5                   
   save_parallel    â”‚ False               
    n_reference     â”‚ 8                   
  save_checkpoints  â”‚ False               
   wandb_project    â”‚ decision-diffuser   
    wandb_entity    â”‚ diegofc             
    wandb_group     â”‚ PandaPush-v3        
     wandb_tags     â”‚ ['decision-diffuser']
     wandb_name     â”‚ safe_omni_combine_basic_3
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        RUN         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       server       â”‚ /home/fernandi/projects/decision-diffuser/code
      username      â”‚ fernandi            
      project       â”‚ diffuser            
    script_root     â”‚ /home/fernandi/projects/decision-diffuser/code/analysis
    script_path     â”‚ None                
        now         â”‚ 2023-10-24 13:58:10.833610+02:00
       prefix       â”‚ diffuser/safe_omni_combine_basic_3
      job_name      â”‚ safe_job            
    job_counter     â”‚ 1                   
       resume       â”‚ True                
       readme       â”‚ None                
       debug        â”‚ False               
CUDA_VISIBLE_DEVICESâ”‚ None                
     file_stem      â”‚ eval                
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
59778366
Traceback (most recent call last):
  File "/home/fernandi/miniconda3/envs/safe3/lib/python3.9/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/fernandi/projects/decision-diffuser/code/scripts/evaluate_safe_parallel_eval.py", line 211, in evaluate
    samples = trainer.ema_model.conditional_sample(conditions, skills=skills)
  File "/home/fernandi/miniconda3/envs/safe3/lib/python3.9/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/home/fernandi/projects/decision-diffuser/code/diffuser/models/diffusion.py", line 749, in conditional_sample
    return self.p_sample_loop(shape, cond, skills=skills, *args, **kwargs)
  File "/home/fernandi/miniconda3/envs/safe3/lib/python3.9/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/home/fernandi/projects/decision-diffuser/code/diffuser/models/diffusion.py", line 726, in p_sample_loop
    x = self.p_sample(x, cond, timesteps, skills=skills)
  File "/home/fernandi/miniconda3/envs/safe3/lib/python3.9/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/home/fernandi/projects/decision-diffuser/code/diffuser/models/diffusion.py", line 708, in p_sample
    model_mean, _, model_log_variance = self.p_mean_variance(x=x, cond=cond, t=t ,skills=skills)
  File "/home/fernandi/projects/decision-diffuser/code/diffuser/models/diffusion.py", line 683, in p_mean_variance
    delta_acc +=self.condition_guidance_w[i]*(epsilon_cond - epsilon_uncond)
TypeError: 'float' object is not subscriptable

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[33m        job         [0m
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
       status       â”‚ errored             
     errorTime      â”‚ 2023-10-24 12:02:10.693472
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•§â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
